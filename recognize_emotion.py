import sounddevice as sdimport soundfile as sfimport opensmileimport joblibimport pandas as pdimport jsonimport time# åˆå§‹åŒ–print("ğŸŒ€ æƒ…ç·’åµæ¸¬å™¨æŒçºŒé‹è¡Œä¸­")duration = 3fs = 16000output_wav = "recorded.wav"# è¼‰å…¥æ¨¡å‹model, expected_columns = joblib.load("emotion_model_with_columns.joblib")# åˆå§‹åŒ– opensmilesmile = opensmile.Smile(    feature_set=opensmile.FeatureSet.eGeMAPSv02,    feature_level=opensmile.FeatureLevel.Functionals,)# æŒçºŒåŸ·è¡Œtry:    while True:        print("\nğŸ™ï¸ éŒ„éŸ³ä¸­...")        recording = sd.rec(int(duration * fs), samplerate=fs, channels=1)        sd.wait()        sf.write(output_wav, recording, fs)        print("âœ… éŒ„éŸ³å®Œæˆï¼Œå„²å­˜ç‚º", output_wav)        print("ğŸ” æ“·å–è²éŸ³ç‰¹å¾µ...")        features = smile.process_file(output_wav)        features.columns = features.columns.astype(str)        # æ¬„ä½å°é½Š        for col in expected_columns:            if col not in features.columns:                features[col] = 0.0        features = features[expected_columns]        # é æ¸¬        prediction = model.predict(features)[0]        proba = model.predict_proba(features).max()        print(f"ğŸ’¡ åµæ¸¬åˆ°çš„æƒ…ç·’ç‚ºï¼š{prediction}ï¼ˆä¿¡å¿ƒåº¦: {proba:.2f}ï¼‰")        # å¯«å…¥ JSON çµ¦ Unity        output = {            "emotion": prediction,            "confidence": round(float(proba), 4),        }        with open("current_emotion.json", "w") as f:            json.dump(output, f)        print("ğŸ“ å·²å¯«å…¥ current_emotion.json")        time.sleep(5)  # æ¯ 5 ç§’åŸ·è¡Œä¸€æ¬¡ï¼Œå¯è‡ªè¡Œèª¿æ•´é–“éš”except KeyboardInterrupt:    print("ğŸ›‘ å·²åœæ­¢æƒ…ç·’åµæ¸¬ã€‚")
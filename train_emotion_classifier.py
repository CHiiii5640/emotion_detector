import pandas as pdfrom sklearn.ensemble import RandomForestClassifierfrom sklearn.model_selection import train_test_splitfrom sklearn.metrics import classification_reportimport joblib# 讀取特徵資料df = pd.read_csv("egemaps_features.csv")# 確保只有數值特徵（不包括字串欄如 filename）feature_columns = df.select_dtypes(include=["number"]).columnsX = df[feature_columns]y = df["emotion"]# 🔒 儲存這些欄位名稱供預測時對齊X.to_csv("feature_columns.csv", index=False)  # 每次都寫入最新特徵名稱# 分割資料X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)# 建立與訓練模型model = RandomForestClassifier(n_estimators=100, random_state=42)model.fit(X_train, y_train)# 評估y_pred = model.predict(X_test)print("📊 分類結果：")print(classification_report(y_test, y_pred))# 儲存模型joblib.dump(model, "emotion_model.joblib")print("✅ 模型已儲存為 emotion_model.joblib")
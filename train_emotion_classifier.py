import pandas as pdfrom sklearn.ensemble import RandomForestClassifierfrom sklearn.model_selection import train_test_splitfrom sklearn.metrics import classification_reportimport joblib# è¼‰å…¥ç‰¹å¾µè³‡æ–™df = pd.read_csv("egemaps_features.csv")# åªé¸æ“‡æ•¸å€¼å‹æ¬„ä½ç•¶ä½œç‰¹å¾µX = df.select_dtypes(include=['number']).drop(columns=["label"], errors="ignore")y = df["emotion"]# åˆ†å‰²è³‡æ–™é›†X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)# è¨“ç·´æ¨¡å‹model = RandomForestClassifier(n_estimators=100, random_state=42)model.fit(X_train, y_train)# è©•ä¼°æ¨¡å‹y_pred = model.predict(X_test)print("ğŸ“Š åˆ†é¡çµæœï¼š")print(classification_report(y_test, y_pred))# âœ… å„²å­˜æ¨¡å‹ + æ¬„ä½åç¨±ï¼ˆç‚ºæ¨è«–ä½¿ç”¨ï¼‰joblib.dump((model, list(X.columns)), "emotion_model_with_columns.joblib")print("âœ… æ¨¡å‹èˆ‡æ¬„ä½å·²å„²å­˜ç‚º emotion_model_with_columns.joblib")
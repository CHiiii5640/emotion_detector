import pandas as pdfrom sklearn.ensemble import RandomForestClassifierfrom sklearn.model_selection import train_test_splitfrom sklearn.metrics import classification_reportimport joblib# è®€å–ç‰¹å¾µè³‡æ–™df = pd.read_csv("egemaps_features.csv")# ç¢ºä¿åªæœ‰æ•¸å€¼ç‰¹å¾µï¼ˆä¸åŒ…æ‹¬å­—ä¸²æ¬„å¦‚ filenameï¼‰feature_columns = df.select_dtypes(include=["number"]).columnsX = df[feature_columns]y = df["emotion"]# ğŸ”’ å„²å­˜é€™äº›æ¬„ä½åç¨±ä¾›é æ¸¬æ™‚å°é½ŠX.to_csv("feature_columns.csv", index=False)  # æ¯æ¬¡éƒ½å¯«å…¥æœ€æ–°ç‰¹å¾µåç¨±# åˆ†å‰²è³‡æ–™X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)# å»ºç«‹èˆ‡è¨“ç·´æ¨¡å‹model = RandomForestClassifier(n_estimators=100, random_state=42)model.fit(X_train, y_train)# è©•ä¼°y_pred = model.predict(X_test)print("ğŸ“Š åˆ†é¡çµæœï¼š")print(classification_report(y_test, y_pred))# å„²å­˜æ¨¡å‹joblib.dump(model, "emotion_model.joblib")print("âœ… æ¨¡å‹å·²å„²å­˜ç‚º emotion_model.joblib")